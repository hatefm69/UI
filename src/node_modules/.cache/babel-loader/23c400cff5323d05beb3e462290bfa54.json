{"ast":null,"code":"var _jsxFileName = \"D:\\\\Projects\\\\React\\\\AMLS\\\\src\\\\pages\\\\projects\\\\companyLoanInfoPage.js\";\nimport { Component } from \"react\";\nimport React from \"react\";\nimport NotificationSystem from \"react-notification-system\";\nimport { Card, TextBox, Helpers, Table, PageMain, DropDown, Label, Delimiter, DatePicker, CellContainer } from \"core\";\nimport { GetUrl, HandleError } from \"../../utils/generals\";\nimport TableHeader from \"../../models/tableHeader\";\nimport TableItem from \"../../models/tableItem\";\nimport Constants from '../../utils/constants';\nimport ConfirmBox from '../../sections/confirmBox'; //const SalaryPaymentSepahBankRate = 1.1;\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SalaryPaymentSepahBankRate = 1;\nexport default class CompanyLoanInfoPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      loans: [],\n      projects: [],\n      monthList: [],\n      loanRates: [],\n      tableRows: [],\n      records: [],\n      updateKey: 1,\n      totalPercentageOfTotalAverageAccount: null,\n      hasLoans: false,\n      disbleProject: false,\n      showConfirm: false,\n      disableProjectEvent: false\n    };\n    this.companyInfoId = this.props.match.params.companyInfoId;\n    this.companyLoanAccountId = this.props.match.params.companyLoanAccountId;\n    this.notificationSystem = /*#__PURE__*/React.createRef();\n    this.formula = [];\n    this.projectId = null;\n    this.lastProjectId = null;\n    this.loanTypeId = null;\n    this.loanTypeName = null;\n    this.foundFormula = null;\n    this.monthNumber = null;\n    this.Index = 1;\n    this.legalCompanyInfo = null;\n    this.loanRateId = null;\n    this.registerDate = null;\n    this.IsValid = this.IsValid.bind(this);\n    this.onProjectSelected = this.onProjectSelected.bind(this);\n    this.onMonthCountSelected = this.onMonthCountSelected.bind(this);\n    this.onLoanTypeSelected = this.onLoanTypeSelected.bind(this);\n    this.AddLoan = this.AddLoan.bind(this);\n    this.RetrivesLoanRates = this.RetrivesLoanRates.bind(this);\n    this.RemoveLoanInfo = this.RemoveLoanInfo.bind(this);\n    this.CalulateTotalPercentageOfTotalAverageAccount = this.CalulateTotalPercentageOfTotalAverageAccount.bind(this);\n    this.GetRecords = this.GetRecords.bind(this);\n    this.onLoanRateSelected = this.onLoanRateSelected.bind(this);\n    this.LoadLoanRates = this.LoadLoanRates.bind(this);\n    this.onConfirm = this.onConfirm.bind(this);\n    this.onRegisterLoans = this.onRegisterLoans.bind(this);\n    this.onCancel = this.onCancel.bind(this); //this.goBack = this.goBack.bind(this);\n  } // Functions.\n\n\n  IsValid(contorlName) {\n    if (this.state[contorlName + \"IsValid\"] == false) {\n      Helpers.DisplayErrorMessage(this.notificationSystem, null, this.state[contorlName + \"ValidFeedBack\"]);\n      return false;\n    }\n\n    return true;\n  }\n\n  RetrivesLoanRates() {\n    this.foundFormula = null;\n    if (this.projectId == null || this.monthNumber == null || this.loanTypeId == null || this.loanRateId == null) return;\n    var formula = this.formula.filter(rd => rd.projectId == this.projectId && rd.monthNumber == this.monthNumber && rd.loanId == this.loanTypeId && rd.rate == this.loanRateId);\n\n    if (formula == null || formula.length <= 0) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'براساس اطلاعات انتخاب شده هیچ فرمولی پیدا نشد');\n      return;\n    }\n\n    if (formula.length > 1) return;\n    this.foundFormula = formula[0];\n  }\n\n  CalulateTotalPercentageOfTotalAverageAccount(records, newAddedSum) {\n    var sum = 0;\n    records.forEach(item => sum = sum + parseFloat(item.PercentageOfTotalAverageAccount));\n    sum = sum + parseInt(newAddedSum);\n\n    if (sum > 100) {\n      Helpers.DisplayErrorMessage(this.notificationSystem, null, 'سهم درصد از مجموع میانگین حساب بیش از 100 درصد شده است');\n      sum = -1;\n    }\n\n    return sum;\n  }\n\n  GetRecords(loanId, percentageOfTotalAverageAccount, rate, paymentBackOfMonthCount, usablePercentageAverage, companyInfoId, companyLoanAccountId, projectId, loanTypeName, createdCredit, creditBalance) {\n    var record = {\n      LoanTypeId: loanId,\n      PercentageOfTotalAverageAccount: percentageOfTotalAverageAccount,\n      LoanRate: rate,\n      PaymentBackOfMonthCount: paymentBackOfMonthCount,\n      UsablePercentageAverage: usablePercentageAverage,\n      LegalCompanyInfoId: companyInfoId,\n      CompanyLoanAccountId: companyLoanAccountId,\n      ProjectId: projectId,\n      Index: this.Index\n    };\n    var row = [];\n    row.push(new TableItem('LoanTypeName', loanTypeName, {\n      Index: this.Index\n    }));\n    row.push(new TableItem('PercentageOfTotalAverageAccount', percentageOfTotalAverageAccount, {\n      Index: this.Index\n    }));\n    row.push(new TableItem('LoanRate', rate, {\n      Index: this.Index\n    }));\n    row.push(new TableItem('PaymentBackOfMonthCount', paymentBackOfMonthCount, {\n      Index: this.Index\n    }));\n    row.push(new TableItem('UsablePercentageAverage', usablePercentageAverage, {\n      Index: this.Index\n    }));\n    if (createdCredit != null) createdCredit = Helpers.FormatNumbers(createdCredit);\n    row.push(new TableItem('CreatedCredit', createdCredit, {\n      Index: this.Index\n    }));\n    if (creditBalance != null) creditBalance = Helpers.FormatNumbers(creditBalance);\n    row.push(new TableItem('CreditBalance', creditBalance, {\n      Index: this.Index\n    }));\n    this.Index++;\n    return {\n      record: record,\n      tableRow: row\n    };\n  }\n\n  LoadLoanRates() {\n    if (this.projectId == null || this.monthNumber == null || this.loanTypeId == null) {\n      this.setState({\n        loanRates: []\n      });\n      return;\n    }\n\n    var rates = [];\n    var loanRates = [];\n    var formula = this.formula.filter(rd => rd.projectId == this.projectId && rd.monthNumber == this.monthNumber && rd.loanId == this.loanTypeId);\n    formula.forEach(item => {\n      if (rates.filter(rt => rt == item.rate).length <= 0) rates.push(item.rate);\n    });\n    rates.sort((a, b) => a - b);\n    rates.forEach(item => loanRates.push({\n      title: item.toString(),\n      label: item.toString(),\n      value: item\n    }));\n    this.setState({\n      loanRates: loanRates\n    });\n  } // Events.\n\n\n  componentDidMount() {\n    Helpers.CallServer('/api/FRQST/CompanyLoan/LoadCompanyLoanPageData', {\n      LegalCompanyInfoId: this.companyInfoId,\n      CompanyLoanAccountId: this.companyLoanAccountId\n    }, successfulResponse => {\n      var dropDowns = successfulResponse.data.dropDowns;\n      var loans = dropDowns.filter(drp => drp.id == Constants.LoanTypes.DropDownId);\n      var projects = dropDowns.filter(drp => drp.id == Constants.Projects);\n      this.legalCompanyInfo = successfulResponse.data.legalCompanyInfo;\n      this.setState({\n        loans: loans == null || loans.length != 1 ? [] : loans[0].values,\n        projects: projects == null || projects.length != 1 ? [] : projects[0].values\n      });\n    }, errorResponse => HandleError(Helpers, this.notificationSystem, errorResponse), () => this.setState({\n      isLoading: false\n    }));\n  }\n\n  onProjectSelected(row) {\n    var states = {};\n    states[\"loanTypeId\"] = null;\n    states[\"paymentBackOfMonthCount\"] = null;\n    states[\"drpLoanRate\"] = null;\n    this.foundFormula = null;\n    this.projectId = null;\n    this.monthNumber = null;\n    this.loanTypeId = null;\n    this.loanTypeName = null;\n    this.loanRateId = null;\n    if (this.state.disableProjectEvent == true) return;\n\n    if (row == null || row.value == null || row.value == '') {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات طرح پیدا نشد');\n      this.projectId = null;\n      this.lastProjectId = null;\n      return;\n    }\n\n    this.projectId = row.value;\n    Helpers.CallServer('/api/FRQST/CompanyLoan/GetCompanyAndFormulaLoans', {\n      ProjectId: this.projectId,\n      CompanyLoanInfoId: this.companyInfoId,\n      CompanyLoanAccountId: this.companyLoanAccountId\n    }, successfulResponse => {\n      this.formula = successfulResponse.data.loansFormula;\n      var companyLoans = successfulResponse.data.companyLoans;\n      var companyLoanAccount = successfulResponse.data.companyLoanAccount;\n      this.registerDate = companyLoanAccount == null ? null : companyLoanAccount.registerDateStr;\n\n      if (companyLoans.length >= 1) {\n        var loans = this.state.loans;\n        var records = [];\n        var tableRows = [];\n        companyLoans.forEach(item => {\n          var loan = loans.filter(ln => ln.value == item.loanTypeId);\n          loan = loan != null && loan.length == 1 ? loan[0].label : '***';\n          var recordData = this.GetRecords(item.loanTypeId, item.percentageOfTotalAverageAccount, item.loanRate, item.paymentBackOfMonthCount, item.usablePercentageAverage, item.legalCompanyInfoId, item.companyLoanAccountId, item.projectId, loan, item.createdCredit, item.creditBalance);\n          records.push(recordData.record);\n          tableRows.push(recordData.tableRow);\n        });\n        var sum = this.CalulateTotalPercentageOfTotalAverageAccount(records, 0);\n        if (sum == -1) return;\n        states['records'] = records;\n        states['tableRows'] = tableRows;\n        states['hasLoans'] = true;\n        states['totalPercentageOfTotalAverageAccount'] = sum;\n      } else {\n        if (this.lastProjectId != this.projectId) {\n          states['records'] = [];\n          states['tableRows'] = [];\n          states['totalPercentageOfTotalAverageAccount'] = 0;\n          this.registerDate = null;\n          states['hasLoans'] = false;\n          states['records'] = [];\n          states['tableRows'] = [];\n        }\n      }\n\n      states['monthList'] = [];\n      states['loanRates'] = [];\n      this.setState(states);\n    }, errorResponse => HandleError(Helpers, this.notificationSystem, errorResponse), () => this.lastProjectId = this.projectId);\n  }\n\n  onMonthCountSelected(row) {\n    this.foundFormula = null;\n    this.monthNumber = null;\n    this.loanRateId == null;\n    this.setState({\n      drpLoanRate: null\n    });\n\n    if (row == null || row.value == null || row.value == '') {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات تعداد ماه باز پرداخت پیدا نشد');\n      return;\n    }\n\n    this.monthNumber = row.value;\n    this.LoadLoanRates();\n    this.RetrivesLoanRates();\n  }\n\n  onLoanRateSelected(row) {\n    this.foundFormula = null;\n    this.loanRateId = null;\n\n    if (row == null || row.value == null || row.value == '') {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات مربوط به نرخ تسهیلات پیدا نشد');\n      return;\n    }\n\n    this.loanRateId = row.value;\n    this.RetrivesLoanRates();\n  }\n\n  onLoanTypeSelected(row) {\n    var states = {};\n    this.foundFormula = null;\n    this.loanTypeId = null;\n    this.loanTypeName = null;\n    this.monthNumber == null;\n    this.loanRateId == null;\n    states[\"paymentBackOfMonthCount\"] = null;\n    states[\"drpLoanRate\"] = null;\n\n    if (row == null || row.value == null || row.value == '') {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات نوع تسهیلات پیدا نشد');\n      this.setState({\n        loanRates: []\n      });\n      return;\n    }\n\n    this.loanTypeId = row.value;\n    this.loanTypeName = row.label;\n    var monthList = [];\n    var monthes = [];\n    this.formula.filter(rd => rd.loanId == this.loanTypeId).forEach(item => {\n      if (monthes.filter(mn => mn == item.monthNumber).length <= 0) monthes.push(item.monthNumber);\n    });\n    monthes.sort((a, b) => a - b);\n    monthes.forEach(item => monthList.push({\n      title: item.toString(),\n      label: item.toString(),\n      value: item\n    }));\n    states[\"monthList\"] = monthList;\n    states[\"loanRates\"] = [];\n    this.setState(states);\n    this.LoadLoanRates();\n    this.RetrivesLoanRates();\n  }\n\n  AddLoan() {\n    var records = this.state.records;\n    var tableRows = this.state.tableRows;\n    var recordCount = records.length;\n    var tableRowCount = tableRows.length;\n\n    if (recordCount != tableRowCount) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'بروز خطا! اطلاعات تسهیلات ناقص می باشد');\n      return;\n    }\n\n    if (recordCount >= 3) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'تنها مجاز به انتخاب سه تسهیلات را دارید');\n      return;\n    }\n\n    if (this.IsValid('projectId') == false) return;\n    if (this.IsValid('loanTypeId') == false) return;\n    if (this.IsValid('percentageOfTotalAverageAccount') == false) return;\n    if (this.IsValid('paymentBackOfMonthCount') == false) return;\n\n    if (this.foundFormula == null) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'فرمول محاسبه تسهیلات پیدا نشد');\n      return;\n    }\n\n    if (this.projectId == null) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات طرح انتخاب شده پیدا نشد');\n      return;\n    }\n\n    if (this.loanTypeId == null) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'نوع تسهیلات انتخاب شده صحیح نمی باشد');\n      return;\n    }\n\n    if (this.loanTypeName == null) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'نام تسهیلات انتخاب شده صحیح نمی باشد');\n      return;\n    }\n\n    if (this.monthNumber == null) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'تعداد ماه باز پرداخت انتخاب شده صحیح نمی باشد');\n      return;\n    }\n\n    if (this.loanRateId == null) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'نرخ تسهیلات انتخاب شده صحیح نمی باشد');\n      return;\n    }\n\n    if (this.loanTypeId == Constants.LoanTypes.GharzolHasane && records.filter(rd => rd.LoanTypeId == this.loanTypeId).length >= 1) {\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'نوع تسهیلات قرض الحسنه فقط یکبار قابل استفاده می باشد');\n      return;\n    }\n\n    var pageData = this.GetRecords(this.foundFormula.loanId, this.state['percentageOfTotalAverageAccount'], this.foundFormula.rate, this.foundFormula.monthNumber, // this.state['paymentBackOfMonthCount']\n    this.legalCompanyInfo.isSalaryPaymentOnSepahBank ? this.foundFormula.usablePercentageAverage * SalaryPaymentSepahBankRate : this.foundFormula.usablePercentageAverage, this.companyInfoId, this.companyLoanAccountId, this.projectId, this.loanTypeName, null, null); //this.projectId = null;\n\n    this.monthNumber = null;\n    this.loanTypeId = null;\n    this.loanTypeName = null;\n    this.foundFormula = null;\n    this.loanRateId == null;\n    var sum = this.CalulateTotalPercentageOfTotalAverageAccount(records, pageData.record.PercentageOfTotalAverageAccount);\n    if (sum == -1) return;\n    records.push(pageData.record);\n    tableRows.push(pageData.tableRow);\n    this.setState({\n      records: records,\n      tableRows: tableRows,\n      loanTypeId: null,\n      percentageOfTotalAverageAccount: null,\n      paymentBackOfMonthCount: null,\n      drpLoanRate: null,\n      totalPercentageOfTotalAverageAccount: sum,\n      updateKey: this.state.updateKey + 1,\n      disbleProject: true\n    });\n  }\n\n  RemoveLoanInfo(option) {\n    var row = option.modalData;\n    var index = row[0].ExtraData.Index;\n    var tableRows = this.state.tableRows;\n    var records = this.state.records;\n    tableRows = tableRows.filter(tbl => tbl[0].ExtraData.Index != index);\n    records = records.filter(rd => rd.Index != index);\n    var sum = this.CalulateTotalPercentageOfTotalAverageAccount(records, 0);\n    if (sum == -1) return;\n    this.monthNumber == null;\n    this.loanTypeId == null;\n    this.loanRateId == null;\n    this.setState({\n      records: records,\n      tableRows: tableRows,\n      totalPercentageOfTotalAverageAccount: sum,\n      updateKey: this.state.updateKey + 1,\n      disbleProject: records.length >= 1 ? true : false,\n      loanTypeId: null,\n      paymentBackOfMonthCount: null,\n      drpLoanRate: null\n    });\n    option.modalOpen = false;\n  }\n\n  onConfirm() {\n    if (this.IsValid('registerDate') == false) {\n      this.setState({\n        showConfirm: false\n      });\n      return;\n    }\n\n    this.setState({\n      isLoading: true\n    });\n    Helpers.CallServer('/api/FRQST/CompanyLoan/RegisterLoans', {\n      records: this.state.records,\n      RegisterDate: this.state.registerDate\n    }, successfulResponse => {\n      this.setState({\n        hasLoans: true,\n        disableProjectEvent: true\n      });\n      Helpers.DisplaySuccessMessage(this.notificationSystem, successfulResponse.message);\n    }, errorResponse => HandleError(Helpers, this.notificationSystem, errorResponse), () => this.setState({\n      isLoading: false,\n      showConfirm: false\n    }));\n  } // GoBack = () => window.history.back();\n\n\n  onRegisterLoans() {\n    var totalPercentage = this.state.totalPercentageOfTotalAverageAccount == null ? 0 : this.state.totalPercentageOfTotalAverageAccount;\n    if (totalPercentage < 100) this.setState({\n      showConfirm: true\n    });else this.onConfirm();\n  }\n\n  onCancel() {\n    this.setState({\n      showConfirm: false\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(PageMain, {\n        context: this,\n        title: \"تفاهم نامه\" + (this.legalCompanyInfo == null ? '' : ' (' + this.legalCompanyInfo.companyName + ')'),\n        icon: \"report-money\",\n        isLoading: this.state.isLoading,\n        topButtons: [{\n          title: \"فهرست شرکت ها\",\n          url: GetUrl(\"legalCompanyInfoListPage\"),\n          color: \"outline-success\",\n          icon: \"list\"\n        }],\n        footerLinks: [{\n          href: \"/\",\n          text: \"صفحه اصلی\"\n        }],\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          context: this,\n          title: \"\\u062C\\u0632\\u0626\\u06CC\\u0627\\u062A \\u062A\\u0641\\u0627\\u0647\\u0645 \\u0646\\u0627\\u0645\\u0647\",\n          icon: \"report-money\",\n          statusColor: \"primary\",\n          hasDefaultSaveButton: false,\n          updateKey: this.state.updateKey,\n          ignoreValidation: true,\n          submitUrl: \"\",\n          hasBackButton: false,\n          onSubmitError: error => HandleError(Helpers, this.notificationSystem, error),\n          children: [/*#__PURE__*/_jsxDEV(DropDown, {\n            context: this,\n            name: \"projectId\",\n            title: \"\\u0637\\u0631\\u062D\",\n            options: this.state.projects,\n            required: true,\n            changeHandler: this.onProjectSelected,\n            disabled: this.state.disbleProject\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DropDown, {\n            context: this,\n            name: \"loanTypeId\",\n            title: \"\\u0646\\u0648\\u0639 \\u062A\\u0633\\u0647\\u06CC\\u0644\\u0627\\u062A\",\n            options: this.state.loans,\n            required: true,\n            changeHandler: this.onLoanTypeSelected\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextBox, {\n            context: this,\n            name: \"percentageOfTotalAverageAccount\",\n            title: \"\\u0633\\u0647\\u0645 \\u062F\\u0631\\u0635\\u062F \\u0627\\u0632 \\u0645\\u062C\\u0645\\u0648\\u0639 \\u0645\\u06CC\\u0627\\u0646\\u06AF\\u06CC\\u0646 \\u062D\\u0633\\u0627\\u0628\",\n            required: true,\n            validateHandler: [Helpers.NumberTypeValidator],\n            leftText: \"%\",\n            maxLength: 3\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 533,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DropDown, {\n            context: this,\n            name: \"paymentBackOfMonthCount\",\n            title: \"\\u062A\\u0639\\u062F\\u0627\\u062F \\u0645\\u0627\\u0647 \\u0628\\u0627\\u0632 \\u067E\\u0631\\u062F\\u0627\\u062E\\u062A \\u062A\\u0633\\u0647\\u06CC\\u0644\\u0627\\u062A\",\n            options: this.state.monthList,\n            required: true,\n            changeHandler: this.onMonthCountSelected\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DropDown, {\n            context: this,\n            name: \"drpLoanRate\",\n            title: \"\\u0646\\u0631\\u062E \\u062A\\u0633\\u0647\\u06CC\\u0644\\u0627\\u062A\",\n            options: this.state.loanRates,\n            required: true,\n            changeHandler: this.onLoanRateSelected\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Label, {\n            name: \"lblUsablePercentageAverage\",\n            context: this,\n            title: \"\\u062F\\u0631\\u0635\\u062F \\u0642\\u0627\\u0628\\u0644 \\u0627\\u0633\\u062A\\u0641\\u0627\\u062F\\u0647 \\u0627\\u0632 \\u0645\\u06CC\\u0627\\u0646\\u06AF\\u06CC\\u0646\",\n            children: [this.foundFormula == null ? '0' : this.legalCompanyInfo.isSalaryPaymentOnSepahBank ? this.foundFormula.usablePercentageAverage * SalaryPaymentSepahBankRate : this.foundFormula.usablePercentageAverage, \" %\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 13\n          }, this), this.registerDate == null ? /*#__PURE__*/_jsxDEV(DatePicker, {\n            context: this,\n            name: \"registerDate\",\n            title: \"\\u062A\\u0627\\u0631\\u06CC\\u062E \\u062B\\u0628\\u062A \\u062A\\u0641\\u0627\\u0647\\u0645 \\u0646\\u0627\\u0645\\u0647\",\n            useEpoch: true,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 544,\n            columnNumber: 19\n          }, this) : /*#__PURE__*/_jsxDEV(Label, {\n            name: \"lblRegisterDate\",\n            context: this,\n            title: \"\\u062A\\u0627\\u0631\\u06CC\\u062E \\u062B\\u0628\\u062A \\u062A\\u0641\\u0627\\u0647\\u0645 \\u0646\\u0627\\u0645\\u0647\",\n            children: this.registerDate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 545,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(Delimiter, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 547,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Label, {\n            name: \"lblTotalPercentageOfTotalAverageAccount\",\n            context: this,\n            title: \"\\u0645\\u062C\\u0645\\u0648\\u0639 \\u0633\\u0647\\u0645 \\u062F\\u0631\\u0635\\u062F \\u0627\\u0632 \\u0645\\u062C\\u0645\\u0648\\u0639 \\u0645\\u06CC\\u0627\\u0646\\u06AF\\u06CC\\u0646 \\u062D\\u0633\\u0627\\u0628: \",\n            children: [this.state.totalPercentageOfTotalAverageAccount == null ? '0' : this.state.totalPercentageOfTotalAverageAccount, \" %\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 548,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Delimiter, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 550,\n            columnNumber: 13\n          }, this), this.state.hasLoans ? null : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col p-2\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                className: \"btn btn-sm btn-outline-primary float-end\",\n                onClick: this.AddLoan,\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"ti me-2 ti-circle-plus\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 558,\n                  columnNumber: 27\n                }, this), \"\\u0627\\u0641\\u0632\\u0648\\u062F\\u0646\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 557,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 556,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 555,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Table, {\n            hasDeleteButton: this.state.hasLoans ? false : true,\n            onDeleteButton: this.RemoveLoanInfo,\n            minHeightTableWrapper: Constants.MinGridHeight,\n            headers: [new TableHeader(\"LoanTypeName\", \"نوع تسهیلات\"), new TableHeader(\"PercentageOfTotalAverageAccount\", \"سهم درصد از مجموع میانگین حساب\"), new TableHeader(\"PaymentBackOfMonthCount\", \"تعداد ماه باز پرداخت تسهیلات\"), new TableHeader(\"LoanRate\", \"نرخ تسهیلات\"), new TableHeader(\"UsablePercentageAverage\", \"درصد قابل استفاده از میانگین\"), new TableHeader(\"CreatedCredit\", \"اعتبار ایجاد شده\"), new TableHeader(\"CreditBalance\", \"مانده اعتبار\")],\n            data: this.state.tableRows\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 563,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Delimiter, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 574,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: this.state.hasLoans ? null : /*#__PURE__*/_jsxDEV(\"a\", {\n                type: \"button\",\n                className: \"btn btn-primary\",\n                onClick: this.onRegisterLoans,\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"me-2 ti ti-checkbox\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 582,\n                  columnNumber: 25\n                }, this), \"\\u062B\\u0628\\u062A \\u0627\\u0637\\u0644\\u0627\\u0639\\u0627\\u062A\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 581,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 576,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 575,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ConfirmBox, {\n            modalIsOpen: this.state.showConfirm,\n            onConfirm: this.onConfirm,\n            onCancel: this.onCancel,\n            title: \"\\u0647\\u0634\\u062F\\u0627\\u0631\",\n            message: \"\\u0645\\u062C\\u0645\\u0648\\u0639 \\u0633\\u0647\\u0645 \\u062F\\u0631\\u0635\\u062F \\u0627\\u0632 \\u0645\\u062C\\u0645\\u0648\\u0639 \\u0645\\u06CC\\u0627\\u0646\\u06AF\\u06CC\\u0646 \\u062D\\u0633\\u0627\\u0628 100 \\u062F\\u0631\\u0635\\u062F \\u0646\\u0634\\u062F\\u0647 \\u0627\\u0633\\u062A. \\u0622\\u06CC\\u0627 \\u0645\\u0627\\u06CC\\u0644 \\u0628\\u0647 \\u062B\\u0628\\u062A \\u0627\\u0637\\u0644\\u0627\\u0639\\u0627\\u062A \\u0647\\u0633\\u062A\\u06CC\\u062F\\u061F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 594,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 528,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 517,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NotificationSystem, {\n        ref: this.notificationSystem\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 598,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}","map":{"version":3,"names":["Component","React","NotificationSystem","Card","TextBox","Helpers","Table","PageMain","DropDown","Label","Delimiter","DatePicker","CellContainer","GetUrl","HandleError","TableHeader","TableItem","Constants","ConfirmBox","SalaryPaymentSepahBankRate","CompanyLoanInfoPage","constructor","props","state","isLoading","loans","projects","monthList","loanRates","tableRows","records","updateKey","totalPercentageOfTotalAverageAccount","hasLoans","disbleProject","showConfirm","disableProjectEvent","companyInfoId","match","params","companyLoanAccountId","notificationSystem","createRef","formula","projectId","lastProjectId","loanTypeId","loanTypeName","foundFormula","monthNumber","Index","legalCompanyInfo","loanRateId","registerDate","IsValid","bind","onProjectSelected","onMonthCountSelected","onLoanTypeSelected","AddLoan","RetrivesLoanRates","RemoveLoanInfo","CalulateTotalPercentageOfTotalAverageAccount","GetRecords","onLoanRateSelected","LoadLoanRates","onConfirm","onRegisterLoans","onCancel","contorlName","DisplayErrorMessage","filter","rd","loanId","rate","length","DisplayWarningMessage","newAddedSum","sum","forEach","item","parseFloat","PercentageOfTotalAverageAccount","parseInt","percentageOfTotalAverageAccount","paymentBackOfMonthCount","usablePercentageAverage","createdCredit","creditBalance","record","LoanTypeId","LoanRate","PaymentBackOfMonthCount","UsablePercentageAverage","LegalCompanyInfoId","CompanyLoanAccountId","ProjectId","row","push","FormatNumbers","tableRow","setState","rates","rt","sort","a","b","title","toString","label","value","componentDidMount","CallServer","successfulResponse","dropDowns","data","drp","id","LoanTypes","DropDownId","Projects","values","errorResponse","states","CompanyLoanInfoId","loansFormula","companyLoans","companyLoanAccount","registerDateStr","loan","ln","recordData","loanRate","legalCompanyInfoId","drpLoanRate","monthes","mn","recordCount","tableRowCount","GharzolHasane","pageData","isSalaryPaymentOnSepahBank","option","modalData","index","ExtraData","tbl","modalOpen","RegisterDate","DisplaySuccessMessage","message","totalPercentage","render","companyName","url","color","icon","href","text","error","NumberTypeValidator","MinGridHeight"],"sources":["D:/Projects/React/AMLS/src/pages/projects/companyLoanInfoPage.js"],"sourcesContent":["import { Component } from \"react\";\r\nimport React from \"react\";\r\nimport NotificationSystem from \"react-notification-system\";\r\nimport { Card, TextBox, Helpers, Table, PageMain, DropDown, Label, Delimiter, DatePicker, CellContainer } from \"core\";\r\nimport { GetUrl, HandleError } from \"../../utils/generals\";\r\nimport TableHeader from \"../../models/tableHeader\";\r\nimport TableItem from \"../../models/tableItem\";\r\nimport Constants from '../../utils/constants'\r\nimport ConfirmBox from '../../sections/confirmBox'\r\n\r\n//const SalaryPaymentSepahBankRate = 1.1;\r\nconst SalaryPaymentSepahBankRate = 1;\r\n\r\nexport default class CompanyLoanInfoPage extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      isLoading: true,\r\n      loans: [],\r\n      projects: [],\r\n      monthList: [],\r\n      loanRates: [],\r\n      tableRows: [],\r\n      records: [],\r\n      updateKey: 1,\r\n      totalPercentageOfTotalAverageAccount: null,\r\n      hasLoans: false,\r\n      disbleProject: false,\r\n      showConfirm: false,\r\n      disableProjectEvent: false\r\n    };\r\n\r\n    this.companyInfoId = this.props.match.params.companyInfoId;\r\n    this.companyLoanAccountId = this.props.match.params.companyLoanAccountId;\r\n\r\n    this.notificationSystem = React.createRef();\r\n    this.formula = [];\r\n    this.projectId = null;\r\n    this.lastProjectId = null;\r\n    this.loanTypeId = null;\r\n    this.loanTypeName = null;\r\n    this.foundFormula = null;\r\n    this.monthNumber = null;\r\n    this.Index = 1;\r\n    this.legalCompanyInfo = null;\r\n    this.loanRateId = null;\r\n    this.registerDate = null;\r\n\r\n    this.IsValid = this.IsValid.bind(this);\r\n    this.onProjectSelected = this.onProjectSelected.bind(this);\r\n    this.onMonthCountSelected = this.onMonthCountSelected.bind(this);\r\n    this.onLoanTypeSelected = this.onLoanTypeSelected.bind(this);\r\n    this.AddLoan = this.AddLoan.bind(this);\r\n    this.RetrivesLoanRates = this.RetrivesLoanRates.bind(this);\r\n    this.RemoveLoanInfo = this.RemoveLoanInfo.bind(this);\r\n    this.CalulateTotalPercentageOfTotalAverageAccount = this.CalulateTotalPercentageOfTotalAverageAccount.bind(this);\r\n    this.GetRecords = this.GetRecords.bind(this);\r\n    this.onLoanRateSelected = this.onLoanRateSelected.bind(this);\r\n    this.LoadLoanRates = this.LoadLoanRates.bind(this);\r\n    this.onConfirm = this.onConfirm.bind(this);\r\n    this.onRegisterLoans = this.onRegisterLoans.bind(this);\r\n    this.onCancel = this.onCancel.bind(this);\r\n    //this.goBack = this.goBack.bind(this);\r\n  }\r\n\r\n  // Functions.\r\n  IsValid(contorlName) {\r\n    if (this.state[contorlName + \"IsValid\"] == false) {\r\n      Helpers.DisplayErrorMessage(this.notificationSystem, null, this.state[contorlName + \"ValidFeedBack\"]);\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  RetrivesLoanRates()\r\n  {\r\n    this.foundFormula = null;\r\n\r\n    if(this.projectId == null || this.monthNumber == null || this.loanTypeId == null || this.loanRateId == null)\r\n      return;\r\n    var formula = this.formula.filter(rd => rd.projectId == this.projectId && rd.monthNumber == this.monthNumber && rd.loanId == this.loanTypeId && rd.rate == this.loanRateId);\r\n\r\n    if(formula == null || formula.length <= 0)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'براساس اطلاعات انتخاب شده هیچ فرمولی پیدا نشد');\r\n      return;\r\n    }\r\n    if(formula.length > 1)\r\n      return;\r\n    this.foundFormula = formula[0];\r\n  }\r\n\r\n  CalulateTotalPercentageOfTotalAverageAccount(records, newAddedSum)\r\n  {\r\n    var sum = 0;\r\n\r\n    records.forEach(item => sum = sum + parseFloat(item.PercentageOfTotalAverageAccount));\r\n    sum = sum + parseInt(newAddedSum);\r\n\r\n    if(sum > 100)\r\n    {\r\n      Helpers.DisplayErrorMessage(this.notificationSystem, null, 'سهم درصد از مجموع میانگین حساب بیش از 100 درصد شده است');\r\n      sum = -1;\r\n    }\r\n    return sum;\r\n  }\r\n\r\n  GetRecords(loanId, percentageOfTotalAverageAccount, rate, paymentBackOfMonthCount, usablePercentageAverage, companyInfoId, companyLoanAccountId, projectId, loanTypeName,\r\n    createdCredit, creditBalance)\r\n  {\r\n    var record = {\r\n\t\t  LoanTypeId: loanId,\r\n\t\t  PercentageOfTotalAverageAccount: percentageOfTotalAverageAccount,\r\n\t\t  LoanRate: rate,\r\n\t\t  PaymentBackOfMonthCount: paymentBackOfMonthCount,\r\n      UsablePercentageAverage: usablePercentageAverage,\r\n\t\t  LegalCompanyInfoId: companyInfoId,\r\n      CompanyLoanAccountId: companyLoanAccountId,\r\n\t\t  ProjectId: projectId,\r\n      Index: this.Index\r\n    };\r\n    var row = [];\r\n    \r\n    row.push(new TableItem('LoanTypeName', loanTypeName, { Index: this.Index }));\r\n    row.push(new TableItem('PercentageOfTotalAverageAccount', percentageOfTotalAverageAccount, { Index: this.Index }));\r\n    row.push(new TableItem('LoanRate', rate, { Index: this.Index }));\r\n    row.push(new TableItem('PaymentBackOfMonthCount', paymentBackOfMonthCount, { Index: this.Index }));\r\n    row.push(new TableItem('UsablePercentageAverage', usablePercentageAverage, { Index: this.Index }));\r\n    \r\n    if(createdCredit != null)\r\n      createdCredit = Helpers.FormatNumbers(createdCredit);\r\n    row.push(new TableItem('CreatedCredit', createdCredit, { Index: this.Index }));\r\n    if(creditBalance != null)\r\n      creditBalance = Helpers.FormatNumbers(creditBalance);\r\n    row.push(new TableItem('CreditBalance', creditBalance, { Index: this.Index }));\r\n\r\n    this.Index++;\r\n    return {\r\n      record: record,\r\n      tableRow: row\r\n    };\r\n  }\r\n\r\n  LoadLoanRates()\r\n  {\r\n    if(this.projectId == null || this.monthNumber == null || this.loanTypeId == null)\r\n    {\r\n      this.setState({ loanRates: [] });\r\n      return;\r\n    }\r\n    var rates = [];\r\n    var loanRates = [];\r\n    var formula = this.formula.filter(rd => rd.projectId == this.projectId && rd.monthNumber == this.monthNumber && rd.loanId == this.loanTypeId);\r\n\r\n    formula.forEach(item =>\r\n      {\r\n        if(rates.filter(rt => rt == item.rate).length <= 0)\r\n          rates.push(item.rate);\r\n      });\r\n    \r\n    rates.sort((a, b) => a - b);\r\n    rates.forEach(item => loanRates.push({ title: item.toString(), label: item.toString(), value: item }));\r\n    \r\n    this.setState({ loanRates: loanRates });\r\n  }\r\n\r\n  // Events.\r\n  componentDidMount()\r\n  {\r\n      Helpers.CallServer('/api/FRQST/CompanyLoan/LoadCompanyLoanPageData',\r\n      {\r\n        LegalCompanyInfoId: this.companyInfoId,\r\n        CompanyLoanAccountId: this.companyLoanAccountId\r\n      },\r\n      successfulResponse =>\r\n      {\r\n          var dropDowns = successfulResponse.data.dropDowns;\r\n          var loans = dropDowns.filter(drp => drp.id == Constants.LoanTypes.DropDownId);\r\n          var projects = dropDowns.filter(drp => drp.id == Constants.Projects);\r\n          this.legalCompanyInfo = successfulResponse.data.legalCompanyInfo;\r\n\r\n          this.setState({\r\n            loans: loans == null || loans.length != 1 ? [] : loans[0].values,\r\n            projects: projects == null || projects.length != 1 ? [] : projects[0].values\r\n          });\r\n      },\r\n      errorResponse => HandleError(Helpers, this.notificationSystem, errorResponse),\r\n      () => this.setState({ isLoading: false }))\r\n  }\r\n\r\n  onProjectSelected(row)\r\n  {\r\n    var states = {};\r\n\r\n    states[\"loanTypeId\"] = null;\r\n    states[\"paymentBackOfMonthCount\"] = null;\r\n    states[\"drpLoanRate\"] = null;\r\n    this.foundFormula = null;\r\n    this.projectId = null;\r\n    this.monthNumber = null;\r\n    this.loanTypeId = null;\r\n    this.loanTypeName = null;\r\n    this.loanRateId = null;\r\n\r\n\r\n    if(this.state.disableProjectEvent == true)\r\n      return;\r\n    if(row == null || row.value == null || row.value == '')\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات طرح پیدا نشد');\r\n      this.projectId = null;\r\n      this.lastProjectId = null;\r\n      return;\r\n    }\r\n    this.projectId = row.value;\r\n\r\n    Helpers.CallServer('/api/FRQST/CompanyLoan/GetCompanyAndFormulaLoans',\r\n    {\r\n      ProjectId: this.projectId,\r\n      CompanyLoanInfoId: this.companyInfoId,\r\n      CompanyLoanAccountId: this.companyLoanAccountId\r\n    },\r\n    successfulResponse =>\r\n    {   \r\n        this.formula = successfulResponse.data.loansFormula;\r\n        var companyLoans = successfulResponse.data.companyLoans;\r\n        var companyLoanAccount = successfulResponse.data.companyLoanAccount;\r\n\r\n        this.registerDate = (companyLoanAccount == null ? null : companyLoanAccount.registerDateStr);\r\n        if(companyLoans.length >= 1)\r\n        {\r\n          var loans = this.state.loans;\r\n          var records = [];\r\n          var tableRows = [];\r\n\r\n          companyLoans.forEach(item =>\r\n            {\r\n              var loan = loans.filter(ln => ln.value == item.loanTypeId);\r\n    \r\n              loan = (loan != null && loan.length == 1 ? loan[0].label : '***');\r\n              var recordData = this.GetRecords(item.loanTypeId, item.percentageOfTotalAverageAccount, item.loanRate, item.paymentBackOfMonthCount,\r\n                                               item.usablePercentageAverage, item.legalCompanyInfoId, item.companyLoanAccountId, item.projectId, loan,\r\n                                               item.createdCredit, item.creditBalance);\r\n\r\n              records.push(recordData.record);\r\n              tableRows.push(recordData.tableRow);\r\n            });\r\n            var sum = this.CalulateTotalPercentageOfTotalAverageAccount(records, 0);\r\n\r\n            if(sum == -1)\r\n              return;\r\n            states['records'] = records;\r\n            states['tableRows'] = tableRows;\r\n            states['hasLoans'] = true;\r\n            states['totalPercentageOfTotalAverageAccount'] = sum;\r\n        }\r\n        else\r\n        {\r\n          if(this.lastProjectId != this.projectId)\r\n          {\r\n            states['records'] = [];\r\n            states['tableRows'] = [];\r\n            states['totalPercentageOfTotalAverageAccount'] = 0;\r\n            this.registerDate = null;\r\n            states['hasLoans'] = false;\r\n            states['records'] = [];\r\n            states['tableRows'] = [];\r\n          }\r\n        }\r\n        states['monthList'] = [];\r\n        states['loanRates'] = [];\r\n\r\n        this.setState(states);\r\n    },\r\n    errorResponse => HandleError(Helpers, this.notificationSystem, errorResponse),\r\n    () => this.lastProjectId = this.projectId);\r\n  }\r\n\r\n  onMonthCountSelected(row)\r\n  {\r\n    this.foundFormula = null;\r\n    this.monthNumber = null;\r\n    this.loanRateId == null;\r\n    this.setState({ drpLoanRate: null });\r\n\r\n    if(row == null || row.value == null || row.value == '')\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات تعداد ماه باز پرداخت پیدا نشد');\r\n      return;\r\n    }\r\n    this.monthNumber = row.value;\r\n\r\n    this.LoadLoanRates();\r\n    this.RetrivesLoanRates();\r\n  }\r\n\r\n  onLoanRateSelected(row)\r\n  {\r\n    this.foundFormula = null;\r\n    this.loanRateId = null;\r\n\r\n    if(row == null || row.value == null || row.value == '')\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات مربوط به نرخ تسهیلات پیدا نشد');\r\n      return;\r\n    }\r\n    this.loanRateId = row.value;\r\n\r\n    this.RetrivesLoanRates();\r\n  }\r\n\r\n  onLoanTypeSelected(row)\r\n  {\r\n    var states = {};\r\n\r\n    this.foundFormula = null;\r\n    this.loanTypeId = null;\r\n    this.loanTypeName = null;\r\n    this.monthNumber == null;\r\n    this.loanRateId == null;\r\n\r\n    states[\"paymentBackOfMonthCount\"] = null;\r\n    states[\"drpLoanRate\"] = null;\r\n\r\n    if(row == null || row.value == null || row.value == '')\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات نوع تسهیلات پیدا نشد');\r\n      this.setState({ loanRates: []});\r\n      return;\r\n    }\r\n    this.loanTypeId = row.value;\r\n    this.loanTypeName = row.label;\r\n    var monthList = [];\r\n    var monthes = [];\r\n\r\n    this.formula.filter(rd => rd.loanId == this.loanTypeId).forEach(item =>\r\n      {\r\n        if(monthes.filter(mn => mn == item.monthNumber).length <= 0)\r\n          monthes.push(item.monthNumber);\r\n      });\r\n    monthes.sort((a, b) => a - b);\r\n    monthes.forEach(item => monthList.push({ title: item.toString(), label: item.toString(), value: item }));\r\n\r\n    states[\"monthList\"] = monthList;\r\n    states[\"loanRates\"] = [];\r\n    this.setState(states);\r\n    this.LoadLoanRates();\r\n    this.RetrivesLoanRates();\r\n  }\r\n\r\n  AddLoan()\r\n  {\r\n    var records = this.state.records;\r\n    var tableRows = this.state.tableRows;\r\n    var recordCount = records.length;\r\n    var tableRowCount = tableRows.length;\r\n\r\n    if(recordCount != tableRowCount)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'بروز خطا! اطلاعات تسهیلات ناقص می باشد');\r\n      return;      \r\n    }\r\n    if(recordCount >= 3)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'تنها مجاز به انتخاب سه تسهیلات را دارید');\r\n      return;\r\n    }\r\n    if(this.IsValid('projectId') == false)\r\n      return;\r\n    if(this.IsValid('loanTypeId') == false)\r\n      return;   \r\n    if(this.IsValid('percentageOfTotalAverageAccount') == false)\r\n      return;   \r\n    if(this.IsValid('paymentBackOfMonthCount') == false)\r\n      return;\r\n    if(this.foundFormula == null)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'فرمول محاسبه تسهیلات پیدا نشد');\r\n      return;\r\n    }\r\n    if(this.projectId == null)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'اطلاعات طرح انتخاب شده پیدا نشد');\r\n      return;\r\n    }\r\n    if(this.loanTypeId == null)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'نوع تسهیلات انتخاب شده صحیح نمی باشد');\r\n      return;\r\n    }\r\n    if(this.loanTypeName == null)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'نام تسهیلات انتخاب شده صحیح نمی باشد');\r\n      return;\r\n    }\r\n    if(this.monthNumber == null)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'تعداد ماه باز پرداخت انتخاب شده صحیح نمی باشد');\r\n      return;\r\n    }\r\n    if(this.loanRateId == null)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'نرخ تسهیلات انتخاب شده صحیح نمی باشد');\r\n      return;\r\n    }\r\n    if(this.loanTypeId == Constants.LoanTypes.GharzolHasane && records.filter(rd => rd.LoanTypeId == this.loanTypeId).length >= 1)\r\n    {\r\n      Helpers.DisplayWarningMessage(this.notificationSystem, null, 'نوع تسهیلات قرض الحسنه فقط یکبار قابل استفاده می باشد');\r\n      return;\r\n    }\r\n    var pageData = this.GetRecords(this.foundFormula.loanId, this.state['percentageOfTotalAverageAccount'], this.foundFormula.rate, this.foundFormula.monthNumber, // this.state['paymentBackOfMonthCount']\r\n                                   (this.legalCompanyInfo.isSalaryPaymentOnSepahBank\r\n                                      ? this.foundFormula.usablePercentageAverage * SalaryPaymentSepahBankRate\r\n                                      : this.foundFormula.usablePercentageAverage), this.companyInfoId, this.companyLoanAccountId, this.projectId, this.loanTypeName,\r\n                                      null, null);\r\n    \r\n    //this.projectId = null;\r\n    this.monthNumber = null;\r\n    this.loanTypeId = null;\r\n    this.loanTypeName = null;\r\n    this.foundFormula = null;\r\n    this.loanRateId == null\r\n    var sum = this.CalulateTotalPercentageOfTotalAverageAccount(records, pageData.record.PercentageOfTotalAverageAccount);\r\n\r\n    if(sum == -1)\r\n      return;\r\n\r\n    records.push(pageData.record);\r\n    tableRows.push(pageData.tableRow);\r\n    this.setState({\r\n      records: records,\r\n      tableRows: tableRows,\r\n      loanTypeId: null,\r\n      percentageOfTotalAverageAccount: null,\r\n      paymentBackOfMonthCount: null,\r\n      drpLoanRate: null,\r\n      totalPercentageOfTotalAverageAccount: sum,\r\n      updateKey: this.state.updateKey + 1,\r\n      disbleProject: true\r\n    });\r\n  }\r\n\r\n  RemoveLoanInfo(option)\r\n  {\r\n    var row = option.modalData;\r\n    var index = row[0].ExtraData.Index;\r\n    var tableRows = this.state.tableRows;\r\n    var records = this.state.records;\r\n\r\n    tableRows = tableRows.filter(tbl => tbl[0].ExtraData.Index != index);\r\n    records = records.filter(rd => rd.Index != index);\r\n\r\n    var sum = this.CalulateTotalPercentageOfTotalAverageAccount(records, 0);\r\n\r\n    if(sum == -1)\r\n      return;\r\n    \r\n    this.monthNumber == null\r\n    this.loanTypeId == null\r\n    this.loanRateId == null\r\n\r\n    this.setState({\r\n      records: records,\r\n      tableRows: tableRows,\r\n      totalPercentageOfTotalAverageAccount: sum,\r\n      updateKey: this.state.updateKey + 1,\r\n      disbleProject: records.length >= 1 ? true : false,\r\n      loanTypeId: null,\r\n      paymentBackOfMonthCount: null,\r\n      drpLoanRate: null\r\n    });\r\n    option.modalOpen = false;\r\n  }\r\n\r\n  onConfirm()\r\n  {\r\n    if(this.IsValid('registerDate') == false)\r\n    {\r\n      this.setState({ showConfirm: false });\r\n      return;\r\n    }\r\n    this.setState({ isLoading: true });\r\n    Helpers.CallServer('/api/FRQST/CompanyLoan/RegisterLoans',\r\n    {\r\n      records: this.state.records,\r\n      RegisterDate: this.state.registerDate\r\n    },\r\n    successfulResponse =>\r\n    {\r\n      this.setState({ hasLoans: true, disableProjectEvent: true });\r\n      Helpers.DisplaySuccessMessage(this.notificationSystem, successfulResponse.message);\r\n    },\r\n    errorResponse => HandleError(Helpers, this.notificationSystem, errorResponse),\r\n    () => this.setState({ isLoading: false, showConfirm: false }));\r\n  }\r\n\r\n  // GoBack = () => window.history.back();\r\n  \r\n  onRegisterLoans()\r\n  {\r\n    var totalPercentage = (this.state.totalPercentageOfTotalAverageAccount == null ? 0 : this.state.totalPercentageOfTotalAverageAccount);\r\n\r\n    if(totalPercentage < 100)\r\n      this.setState({ showConfirm: true });\r\n    else\r\n      this.onConfirm();\r\n  }\r\n\r\n  onCancel()\r\n  {\r\n    this.setState({ showConfirm: false });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <PageMain context={ this } title={ \"تفاهم نامه\" + (this.legalCompanyInfo == null ? '' : ' (' + this.legalCompanyInfo.companyName + ')') }\r\n          icon=\"report-money\" isLoading={ this.state.isLoading }\r\n          topButtons={[\r\n            {\r\n              title: \"فهرست شرکت ها\",\r\n              url: GetUrl(\"legalCompanyInfoListPage\"),\r\n              color: \"outline-success\",\r\n              icon: \"list\",\r\n            }]}\r\n          footerLinks={[{ href: \"/\", text: \"صفحه اصلی\" }]}>\r\n\r\n            <Card context={ this } title=\"جزئیات تفاهم نامه\" icon=\"report-money\" statusColor=\"primary\" hasDefaultSaveButton={ false } updateKey={ this.state.updateKey }\r\n              ignoreValidation submitUrl=\"\" hasBackButton={ false } onSubmitError={ (error) => HandleError(Helpers, this.notificationSystem, error) }>\r\n            \r\n            <DropDown context={ this } name=\"projectId\" title=\"طرح\" options={ this.state.projects } required changeHandler={ this.onProjectSelected } disabled={ this.state.disbleProject } />\r\n            <DropDown context={ this } name=\"loanTypeId\" title=\"نوع تسهیلات\" options={ this.state.loans } required changeHandler={ this.onLoanTypeSelected } />\r\n            <TextBox context={ this } name=\"percentageOfTotalAverageAccount\" title=\"سهم درصد از مجموع میانگین حساب\" required validateHandler={[ Helpers.NumberTypeValidator ]}\r\n              leftText=\"%\" maxLength={ 3 } />\r\n            <DropDown context={ this } name=\"paymentBackOfMonthCount\" title=\"تعداد ماه باز پرداخت تسهیلات\" options={ this.state.monthList } required\r\n              changeHandler={ this.onMonthCountSelected } />\r\n            <DropDown context={ this } name=\"drpLoanRate\" title=\"نرخ تسهیلات\" options={ this.state.loanRates } required changeHandler={ this.onLoanRateSelected } />\r\n            <Label name=\"lblUsablePercentageAverage\" context={ this } title='درصد قابل استفاده از میانگین'>\r\n                { this.foundFormula == null ? '0' : (this.legalCompanyInfo.isSalaryPaymentOnSepahBank\r\n                                                      ? this.foundFormula.usablePercentageAverage * SalaryPaymentSepahBankRate\r\n                                                      : this.foundFormula.usablePercentageAverage) } %</Label>\r\n            {\r\n              this.registerDate == null\r\n                ? <DatePicker context={ this } name=\"registerDate\" title=\"تاریخ ثبت تفاهم نامه\" useEpoch required />\r\n                : <Label name=\"lblRegisterDate\" context={ this } title='تاریخ ثبت تفاهم نامه'>{ this.registerDate }</Label>\r\n            }\r\n            <Delimiter></Delimiter>\r\n            <Label name=\"lblTotalPercentageOfTotalAverageAccount\" context={ this } title='مجموع سهم درصد از مجموع میانگین حساب: '>\r\n              { this.state.totalPercentageOfTotalAverageAccount == null ? '0' : this.state.totalPercentageOfTotalAverageAccount } %</Label>\r\n            <Delimiter></Delimiter>\r\n            {\r\n              this.state.hasLoans\r\n                ? null\r\n                :\r\n                <div className=\"row\">\r\n                  <div className=\"col p-2\">\r\n                      <a className=\"btn btn-sm btn-outline-primary float-end\" onClick={ this.AddLoan }>\r\n                          <i className=\"ti me-2 ti-circle-plus\" />افزودن\r\n                      </a>\r\n                  </div>\r\n                </div>\r\n            }\r\n            <Table hasDeleteButton={ this.state.hasLoans ? false : true } onDeleteButton={ this.RemoveLoanInfo } minHeightTableWrapper={ Constants.MinGridHeight }\r\n              headers={[\r\n                new TableHeader(\"LoanTypeName\", \"نوع تسهیلات\"),\r\n                new TableHeader(\"PercentageOfTotalAverageAccount\", \"سهم درصد از مجموع میانگین حساب\"),\r\n                new TableHeader(\"PaymentBackOfMonthCount\",\"تعداد ماه باز پرداخت تسهیلات\"),\r\n                new TableHeader(\"LoanRate\", \"نرخ تسهیلات\"),\r\n                new TableHeader(\"UsablePercentageAverage\",\"درصد قابل استفاده از میانگین\"),\r\n                new TableHeader(\"CreatedCredit\",\"اعتبار ایجاد شده\"),\r\n                new TableHeader(\"CreditBalance\",\"مانده اعتبار\")\r\n              ]}\r\n              data={ this.state.tableRows } />\r\n              <Delimiter></Delimiter>\r\n              <div className=\"row\">\r\n                <div className=\"col\">\r\n                  {\r\n                    (this.state.hasLoans\r\n                      ? null\r\n                      :\r\n                      <a type='button' className=\"btn btn-primary\" onClick={ this.onRegisterLoans }>\r\n                        <i className=\"me-2 ti ti-checkbox\"></i>\r\n                        ثبت اطلاعات\r\n                      </a>)\r\n                  }\r\n                </div>\r\n                {/* <div className=\"col-6\">\r\n                  <button type='button btn-light' className=\"btn float-end\" onClick={ this.goBack }>\r\n                    بازگشت\r\n                    <i className=\"ti ti-arrow-left ms-1\"></i>\r\n                  </button>\r\n                </div> */}\r\n              </div>\r\n              <ConfirmBox modalIsOpen={ this.state.showConfirm } onConfirm={ this.onConfirm } onCancel={ this.onCancel } title='هشدار'\r\n                message='مجموع سهم درصد از مجموع میانگین حساب 100 درصد نشده است. آیا مایل به ثبت اطلاعات هستید؟' />\r\n            </Card>\r\n        </PageMain>\r\n        <NotificationSystem ref={ this.notificationSystem } />\r\n      </>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}