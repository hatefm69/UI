{"ast":null,"code":"import _classCallCheck from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Component}from\"react\";import React from\"react\";import{Card,Helpers,FileUploader,DropDown,Table,PageMain,AlertBox}from\"core\";import{checkDataIsValid}from\"../../../utils/selectOptionUtils\";import{HandleError,GetUrl,DownloadBlobFile}from\"../../../utils/generals\";import NotificationSystem from\"react-notification-system\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CalendarSettingPage=/*#__PURE__*/function(_Component){_inherits(CalendarSettingPage,_Component);var _super=_createSuper(CalendarSettingPage);function CalendarSettingPage(props){var _this;_classCallCheck(this,CalendarSettingPage);_this=_super.call(this,props);_this.downloadExcel=function(){_this.setState({isLoading:true});Helpers.CallServer(\"/api/cmi/CalendarSetting/GetExcelFileByYear/\"+_this.state.year,{},function(response){DownloadBlobFile(response,\"روزهای تعطیل سال \"+_this.state.year+\".xlsx\");},function(error){return HandleError(_this.notificationSystem,error);},function(){return _this.setState({isLoading:false});},\"POST\",\"blob\");};_this.isNew=_this.props.isNew;_this.state={year:null,formData:{},isLoaded:false,updateKey:1,updateErrorKey:1,errorList:[],yearOptions:[]};_this.pageInfo={title:\"ثبت تعطیلات سالیانه\",icon:\"circle-plus\"};_this.notificationSystem=/*#__PURE__*/React.createRef();_this.onSubmitError=_this.onSubmitError.bind(_assertThisInitialized(_this));return _this;}_createClass(CalendarSettingPage,[{key:\"componentDidMount\",value:function componentDidMount(){var yearOptions=[];for(var index=1404;index<1431;index++){yearOptions.push({name:index,value:index,label:index});}this.setState({yearOptions:yearOptions,updateKey:this.state.updateKey+1});}},{key:\"onSubmitError\",value:function onSubmitError(errorResponse){return HandleError(this.notificationSystem,errorResponse);}},{key:\"onBeforeSubmit\",value:function onBeforeSubmit(){this.setState({errorList:[],updateErrorKey:this.state.updateErrorKey+1});var formData=this.state.formData;formData[\"year\"]=this.state.year;this.setState({formData:formData});return true;}},{key:\"onSubmitSuccess\",value:function onSubmitSuccess(e){if(checkDataIsValid(e)){if(e.data.errorList.length==0){Helpers.DisplaySuccessMessage(this.notificationSystem,e.data.message);}else{var errorList=[];for(var index=0;index<e.data.errorList.length;index++){errorList.push([{name:\"error\",value:e.data.errorList[index]}]);}this.setState({errorList:errorList,updateErrorKey:this.state.updateErrorKey+1});}}else{Helpers.DisplayErrorMessage(this.notificationSystem,e,e.response.data.message);}}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(PageMain,{title:this.pageInfo.title,icon:this.pageInfo.icon,isLoading:this.state.isLoading,topButtons:[{title:\"دریافت فایل نمونه\",url:function url(){return _this2.downloadExcel();},color:\"outline-success\",icon:\"download\"},{title:\"لیست تعطیلات سالیانه\",url:GetUrl(\"calendarSettingListPage\"),color:\"outline-primary\",icon:\"list\"}],footerLinks:[{href:\"/\",text:\"صفحه اصلی\"}],children:[/*#__PURE__*/_jsx(AlertBox,{context:this,type:\"success\",hasIcon:true,children:\"\\u062A\\u0627 \\u0642\\u0628\\u0644 \\u0627\\u0632 \\u0635\\u062F\\u0648\\u0631 \\u0627\\u0648\\u0644\\u06CC\\u0646 \\u062D\\u06A9\\u0645 \\u0627\\u0645\\u06A9\\u0627\\u0646 \\u0628\\u0627\\u0631\\u06AF\\u0630\\u0627\\u0631\\u06CC \\u062A\\u0639\\u0637\\u06CC\\u0644\\u0627\\u062A \\u0628\\u0647 \\u062F\\u0641\\u0639\\u0627\\u062A \\u0648\\u062C\\u0648\\u062F \\u062F\\u0627\\u0631\\u062F\"}),this.state.yearOptions.length>0&&/*#__PURE__*/_jsxs(Card,{context:this,title:\"\",submitUrl:\"/api/cmi/CalendarSetting/Post/\"+this.state.year,hasBackButton:true,statusColor:\"primary\",onSubmitError:this.onSubmitError,onSubmitSuccess:function onSubmitSuccess(e){return _this2.onSubmitSuccess(e);},onBeforeSubmit:function onBeforeSubmit(e){return _this2.onBeforeSubmit(e);},hasDefaultSaveButton:true,formData:this.state.formData,children:[/*#__PURE__*/_jsx(DropDown,{context:this,initialValue:this.state.yearOptions[0].value,title:\"\\u0633\\u0627\\u0644\",name:\"year\",options:this.state.yearOptions,notificationSystem:this.notificationSystem}),/*#__PURE__*/_jsx(FileUploader,{context:this,name:\"files\",title:\"\\u0628\\u0627\\u0631\\u06AF\\u0632\\u0627\\u0631\\u06CC \\u0627\\u0637\\u0644\\u0627\\u0639\\u0627\\u062A\",validExtensions:[\".xlsx\"],lgCol:4,required:true}),this.state.errorList.length>0&&/*#__PURE__*/_jsx(Table,{headers:[{title:\"خطا\",name:\"error\"}],data:this.state.errorList,minHeightTableWrapper:200},\"errorTbl\"+this.state.updateErrorKey)]})]}),/*#__PURE__*/_jsx(NotificationSystem,{ref:this.notificationSystem})]});}}]);return CalendarSettingPage;}(Component);export{CalendarSettingPage as default};","map":null,"metadata":{},"sourceType":"module"}