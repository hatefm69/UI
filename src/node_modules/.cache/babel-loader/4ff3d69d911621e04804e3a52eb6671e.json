{"ast":null,"code":"import _classCallCheck from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Card,CheckBox,DropDown,Helpers,TextBox,FileUploader}from\"core\";import React,{Component}from\"react\";import NotificationSystem from\"react-notification-system\";import Constants from\"../utils/constants\";import{HandleError}from\"../utils/generals\";import{IsLegalPersonNationalIdValid,IsRealPersonNationalIdValid}from'../utils/nationalIdentification';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var defaultName='نام';var defaultCode='کد';var NationalityTypes={Iranian:\"1\",OtherCountry:\"2\"};var PersonInfSecion=/*#__PURE__*/function(_Component){_inherits(PersonInfSecion,_Component);var _super=_createSuper(PersonInfSecion);function PersonInfSecion(props){var _this;_classCallCheck(this,PersonInfSecion);var state={ctlName:defaultName,ctlCode:defaultCode,isActive:false,updateKey:1};_this=_super.call(this,props);if(_this.props.record!=null){state[\"id\"]=_this.props.record.id;state[\"statusId\"]=_this.props.record.statusId.toString();state[\"personTypeId\"]=_this.props.record.personTypeId.toString();state[\"personNationalityId\"]=_this.props.record.personNationalityId.toString();state[\"isActive\"]=_this.props.record.isActive;state[\"name\"]=_this.props.record.name;state[\"code\"]=_this.props.record.code;}_this.state=state;_this.notificationSystem=/*#__PURE__*/React.createRef();_this.onPersonTypeSelected=_this.onPersonTypeSelected.bind(_assertThisInitialized(_this));_this.onPersonnelNationalitySelected=_this.onPersonnelNationalitySelected.bind(_assertThisInitialized(_this));_this.setNationalityLabels=_this.setNationalityLabels.bind(_assertThisInitialized(_this));_this.onBeforeSubmit=_this.onBeforeSubmit.bind(_assertThisInitialized(_this));_this.onSubmitSuccess=_this.onSubmitSuccess.bind(_assertThisInitialized(_this));return _this;}_createClass(PersonInfSecion,[{key:\"setPersonTypeLables\",value:function setPersonTypeLables(value){var name=defaultName;var code=defaultCode;switch(value){case Constants.PersonTypes.Real:name=\"نام و نام خانوادگی\";code=\"کد ملی\";break;case Constants.PersonTypes.Legal:name=\"نام شرکت\";code=\"شناسه ملی\";break;}return{name:name,code:code};}},{key:\"setNationalityLabels\",value:function setNationalityLabels(value){var name=defaultName;var code=defaultCode;if(value==NationalityTypes.Iranian)return this.setPersonTypeLables(this.state.personTypeId);else if(value==NationalityTypes.OtherCountry){name=\"نام شرکت به انگلیسی\";code=\"کد فراگیر اتباع\";}return{name:name,code:code};}},{key:\"isInputValid\",value:function isInputValid(data,isBooleanType){if(isBooleanType==null)return data!=null&&data!=\"\";return data!=null;}// Events.\n},{key:\"onPersonTypeSelected\",value:function onPersonTypeSelected(item){if(item==null||item.value==null||item.value==\"\"){this.setState({ctlName:defaultName,ctlCode:defaultCode});return;}var value=item.value.toString();var personNationalityId=this.state.personNationalityId;var nameCode={name:defaultName,code:defaultCode};if(personNationalityId==NationalityTypes.Iranian||personNationalityId==null)nameCode=this.setPersonTypeLables(value);else if(personNationalityId==NationalityTypes.OtherCountry)nameCode=this.setNationalityLabels(personNationalityId);this.setState({ctlName:nameCode.name,ctlCode:nameCode.code});}},{key:\"onPersonnelNationalitySelected\",value:function onPersonnelNationalitySelected(item){if(item==null||item.value==null||item.value==\"\"){this.setState({ctlName:defaultName,ctlCode:defaultCode});return;}var value=item.value.toString();var nameCode={name:defaultName,code:defaultCode};if(value==NationalityTypes.Iranian)nameCode=this.setPersonTypeLables(this.state.personTypeId);else if(value==NationalityTypes.OtherCountry)nameCode=this.setNationalityLabels(value);this.setState({ctlName:nameCode.name,ctlCode:nameCode.code});}},{key:\"onBeforeSubmit\",value:function onBeforeSubmit(){if(this.state.fulPersonInfo==null||this.state.fulPersonInfo.length==0){if(this.isInputValid(this.state.statusId)==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,'وضعیت شخص را انتخاب نمایید');return false;}if(this.isInputValid(this.state.personTypeId)==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,'نوع مشتری را انتخاب نمایید');return false;}if(this.isInputValid(this.state.personNationalityId)==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,'تابعیت را انتخاب نمایید');return false;}if(this.isInputValid(this.state.name)==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,\"\".concat(this.state.ctlName,\" \\u0631\\u0627 \\u0627\\u0646\\u062A\\u062E\\u0627\\u0628 \\u0646\\u0645\\u0627\\u06CC\\u06CC\\u062F\"));return false;}if(this.isInputValid(this.state.code)==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,\"\".concat(this.state.ctlCode,\" \\u0631\\u0627 \\u0627\\u0646\\u062A\\u062E\\u0627\\u0628 \\u0646\\u0645\\u0627\\u06CC\\u06CC\\u062F\"));return false;}if(this.isInputValid(this.state.isActive,true)==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,'فعال یا غیر فعال بودن را مشخص نمایید');return false;}var personNationalityId=this.state.personNationalityId;if(personNationalityId==NationalityTypes.Iranian){var personTypeId=this.state.personTypeId;if(personTypeId==Constants.PersonTypes.Real){var isVlid=IsRealPersonNationalIdValid(this.state.code);if(isVlid==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,'کد ملی صحیح نمی باشد');return false;}}else if(personTypeId==Constants.PersonTypes.Legal){var isVlid=IsLegalPersonNationalIdValid(this.state.code);if(isVlid==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,'شناسه ملی صحیح نمی باشد');return false;}}}}else{if(this.state.fulPersonInfo.length>1){Helpers.DisplayErrorMessage(this.notificationSystem,null,'حداکثر یک فایل انتخاب نمایید');return false;}}return true;}},{key:\"onSubmitSuccess\",value:function onSubmitSuccess(response){if(this.props.record==null)this.setState({statusId:null,personTypeId:null,personNationalityId:null,isActive:false,name:null,code:null,updateKey:this.state.updateKey+1});Helpers.DisplaySuccessMessage(this.notificationSystem,response.message);}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{context:this,title:this.props.record==null?\"جزئیات افزودن شخص\":\"جزئیات ویرایش شخص\",name:\"crdPersonnelInfo\",statusColor:\"primary\",hasDefaultSaveButton:true,submitUrl:this.props.record==null?\"/api/amls/PersonInfo/AddPerson\":\"/api/amls/PersonInfo/UpdatePerson\",hasBackButton:true,icon:this.props.record==null?\"user-plus\":\"user-check\",onSubmitError:function onSubmitError(error){return HandleError(Helpers,_this2.notificationSystem,error);},onBeforeSubmit:this.onBeforeSubmit,onSubmitSuccess:this.onSubmitSuccess,updateKey:this.state.updateKey,children:[/*#__PURE__*/_jsx(DropDown,{context:this,name:\"statusId\",title:\"\\u0648\\u0636\\u0639\\u06CC\\u062A \\u0634\\u062E\\u0635\",options:this.props.dropDowns.states}),/*#__PURE__*/_jsx(DropDown,{context:this,name:\"personTypeId\",title:\"\\u0646\\u0648\\u0639 \\u0645\\u0634\\u062A\\u0631\\u06CC\",options:this.props.dropDowns.personTypes,changeHandler:this.onPersonTypeSelected,disabled:this.state.personNationalityId==\"2\"?true:false}),/*#__PURE__*/_jsx(DropDown,{context:this,name:\"personNationalityId\",title:\"\\u062A\\u0627\\u0628\\u0639\\u06CC\\u062A\",options:this.props.dropDowns.personNationalities,changeHandler:this.onPersonnelNationalitySelected}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"name\",title:this.state.ctlName,minLength:1,maxLength:64,validateHandler:[Helpers.MinMaxLengthValidator]}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"code\",title:this.state.ctlCode,minLength:10,maxLength:12,validateHandler:[Helpers.MinMaxLengthValidator,Helpers.NumberTypeValidator]}),/*#__PURE__*/_jsx(CheckBox,{context:this,name:\"isActive\",title:\"\\u0641\\u0639\\u0627\\u0644\"}),this.props.record==null?/*#__PURE__*/_jsx(FileUploader,{context:this,name:\"fulPersonInfo\",title:\"\\u0627\\u06CC\\u0645\\u0648\\u0631\\u062A \\u0641\\u0627\\u06CC\\u0644\",validExtensions:['.xlsx']}):null]}),/*#__PURE__*/_jsx(NotificationSystem,{ref:this.notificationSystem})]});}}]);return PersonInfSecion;}(Component);export{PersonInfSecion as default};","map":null,"metadata":{},"sourceType":"module"}