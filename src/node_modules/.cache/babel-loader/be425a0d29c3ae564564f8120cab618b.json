{"ast":null,"code":"import _classCallCheck from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Component}from\"react\";import React from\"react\";import{Helpers,PageMain,Card,TextBox,DropDown,DatePicker,FileUploader}from\"core\";import NotificationSystem from\"react-notification-system\";import{GetUrl,HandleError,DownloadBlobFile}from'../../../utils/generals';import Constants from\"../../../utils/constants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RequestBillingAddPage=/*#__PURE__*/function(_Component){_inherits(RequestBillingAddPage,_Component);var _super=_createSuper(RequestBillingAddPage);function RequestBillingAddPage(props){var _this;_classCallCheck(this,RequestBillingAddPage);_this=_super.call(this,props);_this.state={isLoading:false,updateKey:1,searchMultiPerson:false,cardTopButtons:[]};_this.notificationSystem=/*#__PURE__*/React.createRef();_this.personNumberTypes=[Constants.PersonNumberType.Real,Constants.PersonNumberType.Legal,Constants.PersonNumberType.Foreign];_this.personNumber={Title:null,MaxLength:null};_this.onPersonNumberTypeSelected=_this.onPersonNumberTypeSelected.bind(_assertThisInitialized(_this));_this.onBeforeSubmit=_this.onBeforeSubmit.bind(_assertThisInitialized(_this));_this.onSubmitSuccess=_this.onSubmitSuccess.bind(_assertThisInitialized(_this));_this.onPersonClicked=_this.onPersonClicked.bind(_assertThisInitialized(_this));_this.onMultiPersonClicked=_this.onMultiPersonClicked.bind(_assertThisInitialized(_this));_this.downloadSampleFile=_this.downloadSampleFile.bind(_assertThisInitialized(_this));return _this;}// Events.\n_createClass(RequestBillingAddPage,[{key:\"onPersonNumberTypeSelected\",value:function onPersonNumberTypeSelected(item){if(item==null||item.value==null||item.value==\"\"){this.personNumber={Title:null,MaxLength:null};return;}switch(item.value){case Constants.PersonNumberType.Real.value:this.personNumber={Title:\"کد ملی\",MaxLength:10};break;case Constants.PersonNumberType.Legal.value:this.personNumber={Title:\"شناسه ملی\",MaxLength:11};break;case Constants.PersonNumberType.Foreign.value:this.personNumber={Title:\"کد فراگیر اتباع\",MaxLength:12};break;default:this.personNumber=null;break;}}},{key:\"onBeforeSubmit\",value:function onBeforeSubmit(){if(this.state.searchMultiPerson){var msg='فایل شامل اطلاعات مشتری را آپلود نمایید';if(this.state.fulCustomerImportFiles==null){Helpers.DisplayErrorMessage(this.notificationSystem,null,msg);return false;}var filesCount=this.state.fulCustomerImportFiles.length;if(filesCount<=0){Helpers.DisplayErrorMessage(this.notificationSystem,null,msg);return false;}else if(filesCount>1){Helpers.DisplayErrorMessage(this.notificationSystem,null,'فقط یک فایل آپلود نمایید');return false;}return true;}else{var customerNumber=this.state.customerNumber;var number=this.state.number;if((customerNumber==null||customerNumber=='')&&(number==null||number=='')){Helpers.DisplayErrorMessage(this.notificationSystem,null,'حداقل یکی از پارامترهای شماره مشتری/کد ملی/شناسه ملی و یا کد فراگیر اتباع را وارد نمایید');return false;}return true;}}},{key:\"onSubmitSuccess\",value:function onSubmitSuccess(response){this.setState({customerNumber:null,personNumberTypeId:null,number:null,accountNumber:null,cardNumber:null,transactionFromDateStr:null,transactionToDateStr:null,updateKey:this.state.updateKey+1});Helpers.DisplaySuccessMessage(this.notificationSystem,response.message);}},{key:\"onPersonClicked\",value:function onPersonClicked(){this.setState({searchMultiPerson:false,customerNumberIsValid:true,personNumberTypeIdIsValid:true,numberIsValid:true,accountNumberIsValid:true,cardNumberIsValid:true,transactionFromDateStrIsValid:false,transactionToDateStrIsValid:false,cardTopButtons:[]});}},{key:\"onMultiPersonClicked\",value:function onMultiPersonClicked(){this.setState({searchMultiPerson:true,customerNumberIsValid:true,personNumberTypeIdIsValid:true,numberIsValid:true,accountNumberIsValid:true,cardNumberIsValid:true,transactionFromDateStrIsValid:true,transactionToDateStrIsValid:true,cardTopButtons:[{title:\"نمونه فایل\",url:this.downloadSampleFile,color:\"outline-success\",icon:\"file-import\"}]});}},{key:\"downloadSampleFile\",value:function downloadSampleFile(){var _this2=this;this.setState({isLoading:true});Helpers.CallServer(\"/api/amls/PersonBilling/SamplePersonBillingInputFile\",{},function(successfulResponse){return DownloadBlobFile(successfulResponse,\"Sample Billing Input File.xlsx\");},function(errorResponse){return HandleError(Helpers,_this2.notificationSystem,errorResponse);},function(){return _this2.setState({isLoading:false});},'GET','blob');}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PageMain,{title:\"\\u0627\\u0641\\u0632\\u0648\\u062F\\u0646 \\u062F\\u0631\\u062E\\u0648\\u0627\\u0633\\u062A \\u0635\\u0648\\u0631\\u062A\\u062D\\u0633\\u0627\\u0628\",icon:\"receipt\",footerLinks:[{href:\"/\",text:\"صفحه اصلی\"}],isLoading:this.state.isLoading,topButtons:[{title:\"لیست درخواست دانلود صورتحساب\",url:GetUrl(\"requestBillingListPage\"),color:\"outline-primary\",icon:\"list-search\"}],children:/*#__PURE__*/_jsxs(Card,{context:this,title:\"\\u062C\\u0632\\u0626\\u06CC\\u0627\\u062A \\u0627\\u0641\\u0632\\u0648\\u062F\\u0646 \\u062F\\u0631\\u062E\\u0648\\u0627\\u0633\\u062A \\u0635\\u0648\\u0631\\u062A\\u062D\\u0633\\u0627\\u0628\",name:\"crdRequestBilling\",statusColor:\"primary\",hasDefaultSaveButton:true,submitUrl:\"/api/amls/Request/AddBillingRequest\",hasBackButton:true,icon:\"receipt\",onBeforeSubmit:this.onBeforeSubmit,updateKey:this.state.updateKey,onSubmitError:function onSubmitError(error){return HandleError(Helpers,_this3.notificationSystem,error);},onSubmitSuccess:this.onSubmitSuccess,topButtons:this.state.cardTopButtons,children:[/*#__PURE__*/_jsxs(\"ul\",{class:\"nav nav-tabs\",children:[/*#__PURE__*/_jsx(\"li\",{class:\"nav-item\",children:/*#__PURE__*/_jsx(\"a\",{class:\"nav-link \".concat(this.state.searchMultiPerson?\"\":\"active\"),onClick:this.onPersonClicked,children:\"\\u0635\\u0648\\u0631\\u062A\\u062D\\u0633\\u0627\\u0628 \\u062A\\u06A9\\u06CC\"})}),/*#__PURE__*/_jsx(\"li\",{class:\"nav-item\",children:/*#__PURE__*/_jsx(\"a\",{class:\"nav-link \".concat(this.state.searchMultiPerson?\"active\":\"\"),onClick:this.onMultiPersonClicked,children:\"\\u0635\\u0648\\u0631\\u062A\\u062D\\u0633\\u0627\\u0628 \\u06AF\\u0631\\u0648\\u0647\\u06CC\"})})]}),this.state.searchMultiPerson==true?/*#__PURE__*/_jsx(FileUploader,{context:this,name:\"fulCustomerImportFiles\",title:\"\\u0635\\u0648\\u0631\\u062A\\u062D\\u0633\\u0627\\u0628 \\u06AF\\u0631\\u0648\\u0647\\u06CC\",validExtensions:['.xlsx','.XLSX']}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TextBox,{context:this,name:\"customerNumber\",title:\"\\u0634\\u0645\\u0627\\u0631\\u0647 \\u0645\\u0634\\u062A\\u0631\\u06CC\",minLength:1,maxLength:25}),/*#__PURE__*/_jsx(DropDown,{context:this,name:\"personNumberTypeId\",title:\"\\u0646\\u0648\\u0639 \\u0634\\u062E\\u0635\",options:this.personNumberTypes,changeHandler:this.onPersonNumberTypeSelected}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"number\",title:this.personNumber.Title==null?\"شماره\":this.personNumber.Title,minLength:1,maxLength:this.personNumber.MaxLength==null?1:this.personNumber.MaxLength,readOnly:this.personNumber.Title==null}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"accountNumber\",title:\"\\u0634\\u0645\\u0627\\u0631\\u0647 \\u062D\\u0633\\u0627\\u0628\",minLength:1,maxLength:25}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"cardNumber\",title:\"\\u0634\\u0645\\u0627\\u0631\\u0647 \\u06A9\\u0627\\u0631\\u062A\",minLength:1,maxLength:16}),/*#__PURE__*/_jsx(DatePicker,{context:this,name:\"transactionFromDateStr\",title:\"\\u0627\\u0632 \\u062A\\u0627\\u0631\\u06CC\\u062E \\u062A\\u0631\\u0627\\u06A9\\u0646\\u0634\",required:true}),/*#__PURE__*/_jsx(DatePicker,{context:this,name:\"transactionToDateStr\",title:\"\\u062A\\u0627 \\u062A\\u0627\\u0631\\u06CC\\u062E \\u062A\\u0631\\u0627\\u06A9\\u0646\\u0634\",required:true})]})]})}),/*#__PURE__*/_jsx(NotificationSystem,{ref:this.notificationSystem})]});}}]);return RequestBillingAddPage;}(Component);export{RequestBillingAddPage as default};","map":null,"metadata":{},"sourceType":"module"}