{"ast":null,"code":"import _objectSpread from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _classCallCheck from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"D:/Projects/React/CMI/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Card,DropDown,Helpers,TextBox}from\"core\";import React from\"react\";import NotificationSystem from\"react-notification-system\";import{MaxLengthDescription}from\"../../utils/constants\";import{GetPostSubmitUrl,GetUpdateSubmitUrl,HandleError,getLastShamsiDayByYear}from\"../../utils/generals\";import{isActiveOptions}from\"../../utils/selectOptionUtils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var InspectionPeriodSection=/*#__PURE__*/function(_React$Component){_inherits(InspectionPeriodSection,_React$Component);var _super=_createSuper(InspectionPeriodSection);function InspectionPeriodSection(props){var _this;_classCallCheck(this,InspectionPeriodSection);_this=_super.call(this,props);_this.onBeforeSubmit=function(e){if(_this.state.year==\"\"){Helpers.DisplayErrorMessage(_this.notificationSystem,null,\"سال را وارد نمایید.\");_this.emptyFromDateAndToDateState();return false;}return true;};_this.onSubmitSuccess=function(res){if(_this.props.record==null){_this.EmptyComponent();Helpers.DisplaySuccessMessage(_this.notificationSystem,\"\\u062F\\u0648\\u0631\\u0647 \\u0628\\u0627\\u0632\\u0631\\u0633\\u06CC \\u062C\\u062F\\u06CC\\u062F \\u0628\\u0627 \\u06A9\\u062F '\".concat(res.data,\"' \\u062B\\u0628\\u062A \\u0634\\u062F\"));}else{Helpers.DisplaySuccessMessage(_this.notificationSystem,\"\\u0628\\u0627 \\u0645\\u0648\\u0641\\u0642\\u06CC\\u062A \\u0648\\u06CC\\u0631\\u0627\\u06CC\\u0634 \\u0634\\u062F \\u060C \\u062F\\u0631 \\u062D\\u0627\\u0644 \\u0627\\u0646\\u062A\\u0642\\u0627\\u0644 \\u0628\\u0647 \\u0641\\u0647\\u0631\\u0633\\u062A ...\");setInterval(function(){window.location.href=GetUrl(\"inspectionPeriodListPage\");},3000);}};_this.EmptyComponent=function(){_this.setState({title:\"\",year:\"\",isActive:\"true\",fromDate:\"\",toDate:\"\",description:\"\",deactivationDate:\"\",updateKey:_this.state.updateKey+1});};_this.emptyFromDateAndToDateState=function(){_this.setState({year:\"\",fromDate:\"\",toDate:\"\",updateKey:_this.state.updateKey+1});};_this.handleBlur=function(e){var value=e.target.value;if(e==null||e==undefined||e==\"\"||value==null||value==\"\"||value.trim()==\"\"){Helpers.DisplayErrorMessage(_this.notificationSystem,null,\"سال باید وارد شود.\");_this.emptyFromDateAndToDateState();return;}var yearValue=parseInt(value);if(isNaN(yearValue)){_this.emptyFromDateAndToDateState();return;}if(yearValue<1300||yearValue>1500){Helpers.DisplayErrorMessage(_this.notificationSystem,null,\"مقدار سال باید معتبر وارد شود(بین 1300 تا 1500).\");_this.emptyFromDateAndToDateState();return;}var lastDayOfYear=getLastShamsiDayByYear(value);var firstYear=\"\".concat(yearValue,\"/01/01\");var endYear=\"\".concat(yearValue,\"/12/\").concat(lastDayOfYear);_this.setState({fromDate:firstYear,toDate:endYear,year:yearValue,updateKey:_this.state.updateKey+1});};_this.state={isLoading:false,updateKey:1000,year:\"\"};_this.notificationSystem=/*#__PURE__*/React.createRef();_this.formName=\"inspectionPeriod\";return _this;}_createClass(InspectionPeriodSection,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(this.props.record!=null)this.setState(function(prevState){return _objectSpread(_objectSpread({},_this2.props.record),{},{isActive:_this2.props.record.isActive.toString(),deactivationDate:_this2.props.record.deactivationDateShamsi?_this2.props.record.deactivationDateShamsi:_this2.props.todayDateShamsi,fromDate:_this2.props.record.fromDateShamsi,toDate:_this2.props.record.toDateShamsi,updateKey:prevState.updateKey+1});});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{hasCollapsibleButton:true,context:this,title:\"\\u062B\\u0628\\u062A \\u062F\\u0648\\u0631\\u0647 \\u0628\\u0627\\u0632\\u0631\\u0633\\u06CC\",icon:\"forms\",hasDefaultSaveButton:true,statusColor:\"primary\",submitUrl:this.props.record==null?GetPostSubmitUrl(this.formName):GetUpdateSubmitUrl(this.formName),onSubmitError:function onSubmitError(error){return HandleError(Helpers,_this3.notificationSystem,error);},onBeforeSubmit:this.onBeforeSubmit,onSubmitSuccess:this.onSubmitSuccess,children:[this.props.record!=null&&/*#__PURE__*/_jsx(TextBox,{context:this,name:\"id\",title:\"\\u06A9\\u062F\",readOnly:true}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"title\",title:\"\\u0639\\u0646\\u0648\\u0627\\u0646 \\u062F\\u0648\\u0631\\u0647\",minLength:1,maxLength:256,required:true}),/*#__PURE__*/_jsx(\"div\",{class:\"col-md-6 col-lg-4 my-3\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{class:\"form-label required \",for:\"input-year\",children:\"\\u0633\\u0627\\u0644\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"year\",class:\"form-control\",id:\"input-year\",placeholder:\"\\u0633\\u0627\\u0644 \\u0631\\u0627 \\u0648\\u0627\\u0631\\u062F \\u0646\\u0645\\u0627\\u06CC\\u06CC\\u062F\",maxlength:\"4\",value:this.state.year||\"\",onBlur:this.handleBlur,onChange:function onChange(e){return _this3.setState({year:e.target.value});}}),this.state.year==\"\"&&/*#__PURE__*/_jsx(\"div\",{class:\"invalid-feedback d-block\",children:\"\\u0633\\u0627\\u0644 \\u0631\\u0627 \\u0648\\u0627\\u0631\\u062F \\u0646\\u0645\\u0627\\u06CC\\u06CC\\u062F\"}),/*#__PURE__*/_jsx(\"small\",{class:\"text-muted d-none\"})]})}),/*#__PURE__*/_jsx(DropDown,{context:this,name:\"isActive\",title:\"\\u0648\\u0636\\u0639\\u06CC\\u062A\",required:true,options:isActiveOptions(),initialValue:\"true\"}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"fromDate\",title:\"\\u0627\\u0632 \\u062A\\u0627\\u0631\\u06CC\\u062E\",maxLength:10,readOnly:true}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"toDate\",title:\"\\u062A\\u0627 \\u062A\\u0627\\u0631\\u06CC\\u062E\",maxLength:10,readOnly:true}),this.state.isActive===\"false\"&&/*#__PURE__*/_jsx(TextBox,{context:this,name:\"deactivationDate\",title:\"\\u062A\\u0627\\u0631\\u06CC\\u062E \\u063A\\u06CC\\u0631 \\u0641\\u0639\\u0627\\u0644 \\u0633\\u0627\\u0632\\u06CC\",readOnly:true,initialValue:this.props.record?this.state.deactivationDate:this.props.todayDateShamsi}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"description\",title:\"\\u0634\\u0631\\u062D\",lgCol:12,mdCol:12,multiline:true,multilineRows:3,maxLength:MaxLengthDescription})]},this.state.updateKey),/*#__PURE__*/_jsx(NotificationSystem,{ref:this.notificationSystem})]});}}]);return InspectionPeriodSection;}(React.Component);export{InspectionPeriodSection as default};","map":null,"metadata":{},"sourceType":"module"}