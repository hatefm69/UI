{"ast":null,"code":"import _classCallCheck from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"D:/Projects/React/AMLS/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Component}from\"react\";import React from\"react\";import{Helpers,PageMain,Card,TextBox,DropDown,DatePicker}from\"core\";import NotificationSystem from\"react-notification-system\";import{GetUrl,HandleError}from'../../utils/generals';import Constants from\"../../utils/constants\";import{IsRealPersonNationalIdValid,IsLegalPersonNationalIdValid}from'../../utils/nationalIdentification';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RegisterStrAddPage=/*#__PURE__*/function(_Component){_inherits(RegisterStrAddPage,_Component);var _super=_createSuper(RegisterStrAddPage);function RegisterStrAddPage(props){var _this;_classCallCheck(this,RegisterStrAddPage);_this=_super.call(this,props);_this.personNumberTypes=[Constants.PersonNumberType.Real,Constants.PersonNumberType.Legal,Constants.PersonNumberType.Foreign];_this.personNumber={Title:null,MaxLength:null};_this.customerId=_this.props.match.params.customerId==\"0\"?undefined:_this.props.match.params.customerId;_this.pnumber=_this.props.match.params.pnumber==\"0\"?undefined:_this.props.match.params.pnumber;_this.pnumbertyp=_this.props.match.params.pnumbertyp==\"0\"?undefined:_this.props.match.params.pnumbertyp;_this.state={isLoading:true,updateKey:1,customerNumber:_this.customerId==undefined?null:_this.customerId,personNumberTypeId:_this.pnumbertyp==undefined?null:_this.pnumbertyp.toString(),number:_this.pnumber==undefined?null:_this.pnumber};_this.notificationSystem=/*#__PURE__*/React.createRef();_this.onPersonNumberTypeSelected=_this.onPersonNumberTypeSelected.bind(_assertThisInitialized(_this));_this.onBeforeSubmit=_this.onBeforeSubmit.bind(_assertThisInitialized(_this));_this.onSubmitSuccess=_this.onSubmitSuccess.bind(_assertThisInitialized(_this));_this.renderPage=false;_this.refferenced=false;return _this;}// Events.\n_createClass(RegisterStrAddPage,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(this.customerId==undefined&&this.pnumber==undefined&&this.pnumbertyp==undefined){this.renderPage=true;this.setState({isLoading:false});return;}this.refferenced=true;Helpers.CallServer('/api/amls/Request/GetEpochCurrentDateTime',{},function(successfulResponse){_this2.setState({toReportDate:successfulResponse});},function(errorResponse){return HandleError(Helpers,_this2.notificationSystem,errorResponse);},function(){_this2.setState({isLoading:false});_this2.renderPage=true;},'GET');}},{key:\"onPersonNumberTypeSelected\",value:function onPersonNumberTypeSelected(item){if(item==null||item.value==null||item.value==\"\"){this.personNumber={Title:null,MaxLength:null};return;}switch(item.value){case Constants.PersonNumberType.Real.value:this.personNumber={Title:\"کد ملی\",MaxLength:10};break;case Constants.PersonNumberType.Legal.value:this.personNumber={Title:\"شناسه ملی\",MaxLength:11};break;case Constants.PersonNumberType.Foreign.value:this.personNumber={Title:\"کد فراگیر اتباع\",MaxLength:12};break;default:this.personNumber=null;break;}}},{key:\"onBeforeSubmit\",value:function onBeforeSubmit(){var number=this.state.number;var customerNumber=this.state.customerNumber;if((customerNumber==null||customerNumber==\"\")&&(number==null||number==\"\")){Helpers.DisplayErrorMessage(this.notificationSystem,null,'شماره مشتری یا کد ملی یا شناسه ملی یا کد اتباع را وارد نمایید');return false;}if(number!=null||number!='')switch(this.state.personNumberTypeId){case Constants.PersonNumberType.Real.value:if(IsRealPersonNationalIdValid(number)==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,'کد ملی صحیح نمی باشد');return false;}break;case Constants.PersonNumberType.Legal.value:if(IsLegalPersonNationalIdValid(number)==false){Helpers.DisplayErrorMessage(this.notificationSystem,null,'شناسه ملی صحیح نمی باشد');return false;}break;}return true;}},{key:\"onSubmitSuccess\",value:function onSubmitSuccess(response){this.setState({customerNumber:null,personNumberTypeId:null,number:null,toReportDate:null,updateKey:this.state.updateKey+1});Helpers.DisplaySuccessMessage(this.notificationSystem,response.message);}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PageMain,{title:\"\\u062B\\u0628\\u062A \\u062F\\u0631\\u062E\\u0648\\u0627\\u0633\\u062A STR \\u067E\\u0648\\u0644\\u0634\\u0648\\u06CC\\u06CC\",icon:\"license\",footerLinks:[{href:\"/\",text:\"صفحه اصلی\"}],isLoading:this.state.isLoading,topButtons:[{title:\"فهرست درخواست ثبت STR پولشویی\",url:GetUrl(\"registerStrListPage\"),color:\"outline-primary\",icon:\"list-search\"}],children:this.renderPage&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Card,{context:this,title:\"\\u062C\\u0632\\u0626\\u06CC\\u0627\\u062A \\u062B\\u0628\\u062A \\u062F\\u0631\\u062E\\u0648\\u0627\\u0633\\u062A STR \\u067E\\u0648\\u0644\\u0634\\u0648\\u06CC\\u06CC\",name:\"crdRegisterStr\",statusColor:\"primary\",hasDefaultSaveButton:true,submitUrl:\"/api/amls/Request/AddRegisterStrRequest\",hasBackButton:true,icon:\"license\",onBeforeSubmit:this.onBeforeSubmit,updateKey:this.state.updateKey,onSubmitError:function onSubmitError(error){return HandleError(Helpers,_this3.notificationSystem,error);},onSubmitSuccess:this.onSubmitSuccess,children:[/*#__PURE__*/_jsx(TextBox,{context:this,name:\"customerNumber\",title:\"\\u0634\\u0645\\u0627\\u0631\\u0647 \\u0645\\u0634\\u062A\\u0631\\u06CC\",minLength:1,maxLength:25,readOnly:this.customerId!=undefined}),/*#__PURE__*/_jsx(DropDown,{context:this,name:\"personNumberTypeId\",title:\"\\u0646\\u0648\\u0639 \\u0634\\u062E\\u0635\",options:this.personNumberTypes,changeHandler:this.onPersonNumberTypeSelected,disabled:this.refferenced}),/*#__PURE__*/_jsx(TextBox,{context:this,name:\"number\",title:this.personNumber.Title==null?\"شماره\":this.personNumber.Title,minLength:1,maxLength:this.personNumber.MaxLength==null?1:this.personNumber.MaxLength,readOnly:this.personNumber.Title==null||this.pnumber!=undefined}),/*#__PURE__*/_jsx(DatePicker,{context:this,name:\"toReportDate\",title:\"\\u062A\\u0627\\u0631\\u06CC\\u062E \\u06AF\\u0632\\u0627\\u0631\\u0634 \\u062A\\u0627\",useEpoch:true,required:true})]})})}),/*#__PURE__*/_jsx(NotificationSystem,{ref:this.notificationSystem})]});}}]);return RegisterStrAddPage;}(Component);export{RegisterStrAddPage as default};","map":null,"metadata":{},"sourceType":"module"}